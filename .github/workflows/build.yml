name: Build Windows Exe
on: [push]

jobs:
  build:
    runs-on: ubuntu-latest
    steps:
      - uses: actions/checkout@v4

      # 1. 使用官方的 Fyne Cross Action
      # 它会自动拉取 Docker 镜像，配置好 Windows 编译环境
      - name: Build for Windows
        uses: fyne-io/fyne-cross-action@master
        with:
          target: windows
          arch: amd64
          # 这里定义输出文件名 (不带 .exe 后缀，工具会自动加)
          output: YoloTools
          # 编译参数：-id 是为了消除 "Preferences API" 警告
          # -app-id 必须与你在 main.go 里 app.NewWithID(...) 填的一致
          args: -app-id yolo.tools.custom

      # 2. 调试步骤：列出文件 (如果失败，方便看文件去哪了)
      - name: List files (Debug)
        run: ls -R fyne-cross

      # 3. 上传结果
      # Fyne Cross 默认把编译好的文件放在 fyne-cross/bin/windows-amd64/ 目录下
      - name: Upload Artifact
        uses: actions/upload-artifact@v4
        with:
          name: Windows-Exe-Tool
          path: fyne-cross/bin/windows-amd64/YoloTools.exe